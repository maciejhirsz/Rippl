<!DOCTYPE html>
<html lang="en">
  <head>
    <title>KineticJS - sprite performance example</title>
    <meta charset="utf-8">
  </head>
  <body>
    <div id="container" width="400" height="400"></div>
    This demo is using KineticJS in order to compare performance to Rippl, the whole logic aside from the api is identical.

    <script src="kinetic/kinetic.js"></script>
    <script>

      var stage = new Kinetic.Stage({
        container: "container",
        width: 400,
        height: 400
      });

      var layer = new Kinetic.Layer();

      stage.add(layer);

      var imageObj = new Image();
      imageObj.onload = function() {

        var i, limit = 250;
        var sprites = [];

        for(i=0; i<limit; i+=1){

          var sprite = new Kinetic.Sprite({
            x: 200-64 + (Math.random() - 0.5) * 400,
            y: 200-64 + (Math.random() - 0.5) * 400,
            opacity: 0.25,
            animations: {
              idle: [{
                x: 0,
                y: 0,
                width: 128,
                height: 128
              }]
            },
            animation: 'idle',
            frameRate: 0,
            image: imageObj
          });
          layer.add(sprite);
          sprites.push(sprite);
          sprite.start();
        }

        var fps, totalTime, lastTime = (new Date).getTime();
        var times = [0, 0, 0, 0, 0, 0];

        var counter = new Kinetic.Text({
          text: "FPS: 0",
          fontStyle: 'bold',
          fontSize: 20,
          textFill: '#000',
          x: 10,
          y: 10,
          shadow: {
            color: '#fff',
            blur: 5,
          }
        });

        layer.add(counter);

        layer.beforeDraw(function(){
          var time = (new Date).getTime();
          times.shift();
          times.push(time - lastTime);
          lastTime = time;

          totalTime = 0;
          for(i=0; i<6; i+=1){
            totalTime += times[i];
          }

          fps = (Math.round(600000 / totalTime)) / 100;

          counter.setText("FPS: "+fps);

          var t = time / 1000;
          var sin = Math.sin(t * 4);

          var x = 1 + sin / 10;
          var y = 1 - sin / 10;

          for(i=0; i<limit; i+=1){
            sprites[i].setScale(x, y);
          }
        });
      }

      imageObj.src = 'img/html5.png';

    </script>
  </body>
</html>